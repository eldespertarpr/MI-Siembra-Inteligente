<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mi Siembra Inteligente</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#22c55e" />

  <style>
    :root {
      color-scheme: dark;
      --bg: #020617;
      --bg-elevated: #02081f;
      --card: #02081f;
      --card-soft: #030919;
      --accent: #22c55e;
      --accent-soft: rgba(34,197,94,0.12);
      --accent-strong: rgba(34,197,94,0.4);
      --text-main: #f9fafb;
      --text-soft: #9ca3af;
      --border-subtle: rgba(148,163,184,0.3);
      --danger: #ef4444;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at top left, #064e3b 0, transparent 55%),
        radial-gradient(circle at bottom right, #0f172a 0, transparent 55%),
        var(--bg);
      color: var(--text-main);
      -webkit-font-smoothing: antialiased;
    }

    .app {
      max-width: 960px;
      margin: 0 auto;
      padding: 1.25rem 0.75rem 4.5rem;
    }

    header.app-header {
      background: linear-gradient(135deg, #022c22, #020617);
      border-radius: 1.5rem;
      padding: 1.25rem;
      border: 1px solid rgba(34,197,94,0.35);
      box-shadow:
        0 18px 40px rgba(15,118,110,0.5),
        0 0 0 1px rgba(15,23,42,0.4);
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(18px);
    }

    .app-header-main {
      display: flex;
      align-items: center;
      gap: 0.85rem;
      margin-bottom: 0.75rem;
    }

    .app-logo {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #bbf7d0 0, #16a34a 32%, #16a34a 60%, #052e16 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 0 3px rgba(34,197,94,0.35);
      font-size: 1.4rem;
    }

    .app-logo span {
      display: inline-block;
      transform: translateY(1px);
    }

    .app-header-text h1 {
      font-size: 1.15rem;
      margin: 0;
      font-weight: 650;
    }

    .app-header-text p {
      margin: 0.15rem 0 0;
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .app-header-nav {
      display: flex;
      gap: 0.4rem;
      margin-top: 0.4rem;
      flex-wrap: wrap;
    }

    .nav-pill {
      border-radius: 999px;
      padding: 0.3rem 0.85rem;
      font-size: 0.78rem;
      border: 1px solid transparent;
      background: rgba(15,23,42,0.7);
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .nav-pill[data-nav="inicio"]::before { content: "üè†"; }
    .nav-pill[data-nav="calendario"]::before { content: "üìÖ"; }
    .nav-pill[data-nav="catalogo"]::before { content: "üå±"; }
    .nav-pill[data-nav="huerto"]::before { content: "üß©"; }
    .nav-pill[data-nav="diario"]::before { content: "üìí"; }
    .nav-pill[data-nav="plagas"]::before { content: "üêõ"; }
    .nav-pill[data-nav="abonos"]::before { content: "üß™"; }
    .nav-pill[data-nav="acerca"]::before { content: "‚ÑπÔ∏è"; }

    .nav-pill.is-active {
      background: radial-gradient(circle at top left, #22c55e, #16a34a);
      color: #022c22;
      border-color: rgba(34,197,94,0.9);
      box-shadow:
        0 0 0 1px rgba(22,163,74,0.7),
        0 0 20px rgba(34,197,94,0.7);
      font-weight: 600;
    }

    main {
      margin-top: 1.25rem;
      display: grid;
      gap: 1.25rem;
    }

    section.section {
      display: none;
      background: radial-gradient(circle at top left, rgba(34,197,94,0.10), transparent 55%), var(--bg-elevated);
      border-radius: 1.5rem;
      padding: 1.25rem 1.1rem 1.4rem;
      border: 1px solid rgba(15,23,42,0.9);
      box-shadow:
        0 20px 45px rgba(15,23,42,0.85),
        0 0 0 1px rgba(15,23,42,0.4);
    }

    section.section.is-active {
      display: block;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.9rem;
    }

    .section-header h2 {
      margin: 0;
      font-size: 1rem;
    }

    .section-header p {
      margin: 0.15rem 0 0;
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .chip {
      font-size: 0.75rem;
      border-radius: 999px;
      padding: 0.3rem 0.75rem;
      border: 1px solid rgba(148,163,184,0.5);
      background: rgba(15,23,42,0.9);
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      white-space: nowrap;
    }

    .chip.green {
      border-color: rgba(34,197,94,0.8);
      color: #bbf7d0;
      background: rgba(22,163,74,0.16);
    }

    .card-grid {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 0.75rem;
    }

    @media (min-width: 680px) {
      .card-grid.two {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .card {
      border-radius: 1.25rem;
      padding: 0.9rem 0.9rem 0.95rem;
      background: radial-gradient(circle at top left, rgba(34,197,94,0.13), transparent 58%), var(--card);
      border: 1px solid rgba(15,23,42,0.9);
      box-shadow: 0 14px 36px rgba(15,23,42,0.85);
      position: relative;
      overflow: hidden;
    }

    .card h3 {
      margin: 0 0 0.25rem;
      font-size: 0.95rem;
    }

    .card p {
      margin: 0;
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      margin-top: 0.6rem;
    }

    .badge {
      font-size: 0.72rem;
      border-radius: 999px;
      padding: 0.15rem 0.55rem;
      border: 1px solid rgba(148,163,184,0.5);
      color: var(--text-soft);
      background: rgba(15,23,42,0.9);
    }

    .badge.green {
      border-color: rgba(22,163,74,0.9);
      color: #bbf7d0;
      background: rgba(22,163,74,0.18);
    }

    .badge.orange {
      border-color: #f97316;
      color: #fed7aa;
      background: rgba(248,113,22,0.18);
    }

    .badge.blue {
      border-color: #38bdf8;
      color: #e0f2fe;
      background: rgba(56,189,248,0.18);
    }

    .badge.red {
      border-color: #f97373;
      color: #fecaca;
      background: rgba(248,113,113,0.14);
    }

    .btn {
      appearance: none;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      background: rgba(15,23,42,0.95);
      color: var(--text-main);
      font-size: 0.8rem;
      padding: 0.45rem 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      cursor: pointer;
      margin-top: 0.65rem;
    }

    .btn.primary {
      border-color: rgba(34,197,94,0.85);
      background: radial-gradient(circle at top left, #22c55e, #16a34a);
      color: #022c22;
      box-shadow:
        0 0 0 1px rgba(22,163,74,0.8),
        0 12px 30px rgba(22,163,74,0.8);
      font-weight: 600;
    }

    .btn.danger {
      border-color: rgba(248,113,113,0.85);
      background: radial-gradient(circle at top left, #ef4444, #b91c1c);
      color: #fef2f2;
    }

    .btn.small {
      padding: 0.25rem 0.6rem;
      font-size: 0.75rem;
    }

    .btn:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    .field-group {
      display: grid;
      gap: 0.55rem;
      margin-top: 0.4rem;
      margin-bottom: 0.4rem;
    }

    label {
      font-size: 0.78rem;
      color: var(--text-soft);
      margin-bottom: 0.1rem;
      display: block;
    }

    input[type="text"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      padding: 0.4rem 0.5rem;
      border-radius: 0.7rem;
      border: 1px solid rgba(30,64,175,0.9);
      background: rgba(15,23,42,0.9);
      color: var(--text-main);
      font-size: 0.8rem;
      font-family: inherit;
      resize: vertical;
      min-height: 2.1rem;
    }

    textarea {
      min-height: 4rem;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: 2px solid rgba(34,197,94,0.9);
      outline-offset: 1px;
    }

    .huerto-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 0.4rem;
      margin-top: 0.6rem;
    }

    .huerto-cell {
      min-height: 54px;
      border-radius: 0.85rem;
      border: 1px dashed rgba(55,65,81,0.9);
      background: radial-gradient(circle at top left, rgba(34,197,94,0.18), transparent 60%), #020617;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 0.76rem;
      color: var(--text-soft);
      padding: 0.25rem;
      cursor: pointer;
    }

    .huerto-cell.filled {
      border-style: solid;
      border-color: rgba(34,197,94,0.9);
      color: #bbf7d0;
      font-weight: 600;
    }

    .huerto-legend {
      margin-top: 0.5rem;
      font-size: 0.78rem;
      color: var(--text-soft);
    }

    ul,
    ol {
      margin: 0.45rem 0 0;
      padding-left: 1.15rem;
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .diary-list {
      list-style: none;
      padding: 0;
      margin-top: 0.7rem;
      display: grid;
      gap: 0.6rem;
    }

    .diary-item {
      border-radius: 1rem;
      padding: 0.65rem 0.7rem 0.6rem;
      background: var(--card-soft);
      border: 1px solid rgba(31,41,55,0.95);
      display: grid;
      gap: 0.2rem;
    }

    .diary-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.4rem;
      margin-bottom: 0.1rem;
    }

    .diary-item-title {
      font-size: 0.82rem;
      font-weight: 600;
    }

    .diary-item-notes {
      font-size: 0.79rem;
      color: var(--text-soft);
      white-space: pre-wrap;
    }

    .empty-state {
      margin-top: 0.7rem;
      font-size: 0.78rem;
      color: var(--text-soft);
    }

    footer {
      margin-top: 1.6rem;
      text-align: center;
      font-size: 0.78rem;
      color: var(--text-soft);
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="app-header-main">
        <div class="app-logo" aria-hidden="true">
          <span>üå±</span>
        </div>
        <div class="app-header-text">
          <h1>Mi Siembra Inteligente</h1>
          <p>Planifica, registra y cuida tu huerto paso a paso.</p>
        </div>
      </div>

      <nav class="app-header-nav" aria-label="Navegaci√≥n principal">
        <button class="nav-pill is-active" data-nav="inicio">Inicio</button>
        <button class="nav-pill" data-nav="calendario">Calendario</button>
        <button class="nav-pill" data-nav="catalogo">Cat√°logo</button>
        <button class="nav-pill" data-nav="huerto">Mi huerto</button>
        <button class="nav-pill" data-nav="diario">Diario</button>
        <button class="nav-pill" data-nav="plagas">Plagas y cuidados</button>
        <button class="nav-pill" data-nav="abonos">Abonos</button>
        <button class="nav-pill" data-nav="acerca">M√°s</button>
      </nav>
    </header>

    <main>
      <!-- INICIO -->
      <section class="section is-active" id="inicio" data-section="inicio">
        <div class="section-header">
          <div>
            <h2>Inicio</h2>
            <p>Elige qu√© quieres hacer hoy en tu siembra.</p>
          </div>
          <span class="chip green">‚ö° PWA offline</span>
        </div>

        <div class="card-grid">
          <article class="card">
            <h3>Qu√© sembrar este mes</h3>
            <p>Calendario por mes con cultivos recomendados y tiempo de cosecha.</p>
            <div class="badge-row">
              <span class="badge green">Recomendado</span>
              <span class="badge">R√°pida consulta</span>
            </div>
            <button class="btn primary" data-goto="calendario">Ver calendario</button>
          </article>

          <article class="card">
            <h3>Cat√°logo de cultivos</h3>
            <p>Explora fichas visuales con tipo de cultivo, sol recomendado y notas.</p>
            <div class="badge-row">
              <span class="badge blue">Visual</span>
              <span class="badge">Gu√≠a r√°pida</span>
            </div>
            <button class="btn primary" data-goto="catalogo">Abrir cat√°logo</button>
          </article>

          <article class="card">
            <h3>Mi huerto 4√ó4</h3>
            <p>Dise√±a un peque√±o plano de 4√ó4 y marca qu√© hay sembrado en cada cuadro.</p>
            <div class="badge-row">
              <span class="badge green">Organiza tu espacio</span>
              <span class="badge">Ideal patios peque√±os</span>
            </div>
            <button class="btn primary" data-goto="huerto">Ir a Mi huerto</button>
          </article>

          <article class="card">
            <h3>Diario de siembra</h3>
            <p>Registra siembras, riegos, abonos y cosechas para no olvidar ning√∫n detalle.</p>
            <div class="badge-row">
              <span class="badge">Registro personal</span>
              <span class="badge blue">Orden cronol√≥gico</span>
            </div>
            <button class="btn primary" data-goto="diario">Abrir diario</button>
          </article>
        </div>
      </section>

      <!-- CALENDARIO -->
      <section class="section" id="calendario" data-section="calendario">
        <div class="section-header">
          <div>
            <h2>Qu√© sembrar este mes</h2>
            <p>Selecciona el mes y revisa qu√© se recomienda sembrar.</p>
          </div>
          <span class="chip">üìç Clima tropical/subtropical</span>
        </div>

        <div class="field-group">
          <div>
            <label for="calendario-mes">Mes</label>
            <select id="calendario-mes"></select>
          </div>
        </div>

        <div id="calendario-lista"></div>
      </section>

      <!-- CATALOGO -->
      <section class="section" id="catalogo" data-section="catalogo">
        <div class="section-header">
          <div>
            <h2>Cat√°logo de cultivos</h2>
            <p>Fichas b√°sicas para los cultivos m√°s comunes.</p>
          </div>
          <span class="chip">üîé Toca cada ficha para leerla con calma</span>
        </div>

        <div class="card-grid two" id="catalogo-grid"></div>
      </section>

      <!-- MI HUERTO -->
      <section class="section" id="huerto" data-section="huerto">
        <div class="section-header">
          <div>
            <h2>Mi huerto 4√ó4</h2>
            <p>Toca un cuadro para anotar qu√© sembraste.</p>
          </div>
          <span class="chip green">üìê Plano sencillo</span>
        </div>

        <div class="huerto-grid" id="huerto-grid"></div>

        <p class="huerto-legend">
          Toca un cuadro para escribir el cultivo (por ejemplo: <strong>Tomate</strong> o <strong>Cilantrillo</strong>).  
          Usa el bot√≥n de abajo para borrar todo el plano si quieres empezar de nuevo.
        </p>

        <button class="btn small" id="huerto-limpiar">
          üßπ Limpiar todo el huerto
        </button>
      </section>

      <!-- DIARIO -->
      <section class="section" id="diario" data-section="diario">
        <div class="section-header">
          <div>
            <h2>Diario de siembra</h2>
            <p>Registra siembras, riegos, abonos, podas y cosechas.</p>
          </div>
          <span class="chip">‚úçÔ∏è Guarda los detalles importantes</span>
        </div>

        <form id="diary-form" autocomplete="off">
          <div class="field-group">
            <div>
              <label for="diary-type">Tipo de actividad</label>
              <select id="diary-type" required>
                <option value="">Selecciona una opci√≥n</option>
                <option>Siembra</option>
                <option>Riego</option>
                <option>Abono</option>
                <option>Control de plagas</option>
                <option>Poda</option>
                <option>Cosecha</option>
                <option>Otro</option>
              </select>
            </div>
            <div>
              <label for="diary-date">Fecha</label>
              <input id="diary-date" type="date" required />
            </div>
          </div>

          <div class="field-group">
            <div>
              <label for="diary-notes">Notas (qu√© hiciste, qu√© cultivo, observaciones)</label>
              <textarea id="diary-notes" placeholder="Ejemplo: Sembr√© 4 matas de tomate en la esquina norte del huerto."></textarea>
            </div>
          </div>

          <button class="btn primary" type="submit">
            üíæ Guardar en el diario
          </button>
        </form>

        <div id="diary-empty" class="empty-state">
          A√∫n no tienes entradas en el diario. Comienza registrando tu pr√≥xima actividad en el huerto.
        </div>

        <ul class="diary-list" id="diary-list"></ul>
      </section>

      <!-- PLAGAS -->
      <section class="section" id="plagas" data-section="plagas">
        <div class="section-header">
          <div>
            <h2>Plagas y cuidados</h2>
            <p>Problemas comunes y qu√© puedes hacer de forma sencilla.</p>
          </div>
          <span class="chip">ü™≤ Lista b√°sica</span>
        </div>

        <div class="card-grid">
          <article class="card">
            <h3>Hormigas en la siembra</h3>
            <p>Pueden da√±ar semillas reci√©n sembradas o brotes muy tiernos.</p>
            <ul>
              <li>Riega menos la zona para no atraerlas.</li>
              <li>Rodea la base de las plantas con canela o caf√© usado.</li>
              <li>Evita dejar comida azucarada cerca del huerto.</li>
            </ul>
          </article>

          <article class="card">
            <h3>Babosas y caracoles</h3>
            <p>Dejan hoyos grandes en hojas y rastros de baba.</p>
            <ul>
              <li>Revisa de noche con linterna y ret√≠ralos a mano.</li>
              <li>Puedes usar recipientes con cerveza como trampa.</li>
              <li>Coloca barreras de ceniza o c√°scara de huevo triturada.</li>
            </ul>
          </article>

          <article class="card">
            <h3>Hojas amarillas</h3>
            <p>Puede ser exceso de agua, falta de nutrientes o sol muy fuerte.</p>
            <ul>
              <li>Verifica que la tierra drene bien.</li>
              <li>No riegues todos los d√≠as si la tierra a√∫n est√° h√∫meda.</li>
              <li>Aplica un abono suave cada varias semanas.</li>
            </ul>
          </article>

          <article class="card">
            <h3>Hongos en el suelo</h3>
            <p>Manchas blancas o gris√°ceas en la superficie.</p>
            <ul>
              <li>Mejora la ventilaci√≥n entre plantas.</li>
              <li>Evita mojar mucho las hojas al regar.</li>
              <li>Retira hojas muy afectadas.</li>
            </ul>
          </article>
        </div>
      </section>

      <!-- ABONOS -->
      <section class="section" id="abonos" data-section="abonos">
        <div class="section-header">
          <div>
            <h2>Abonos y fertilizantes</h2>
            <p>Ideas de abonos caseros y cu√°ndo aplicarlos.</p>
          </div>
          <span class="chip">üåø Cuidado b√°sico</span>
        </div>

        <div class="card-grid">
          <article class="card">
            <h3>Compost casero</h3>
            <p>Mezcla de restos de cocina (vegetales), hojas secas y recortes de c√©sped.</p>
            <ul>
              <li>Aplica una capa fina alrededor de las plantas.</li>
              <li>Mejora la estructura del suelo y retiene humedad.</li>
              <li>Evita poner carnes o grasas.</li>
            </ul>
          </article>

          <article class="card">
            <h3>Caf√© usado</h3>
            <p>Aporta algo de nitr√≥geno y mejora la textura del suelo.</p>
            <ul>
              <li>Ideal para plantas que disfrutan suelos ligeramente √°cidos.</li>
              <li>No abuses: una capa muy fina es suficiente.</li>
            </ul>
          </article>

          <article class="card">
            <h3>C√°scaras de huevo</h3>
            <p>A√±aden calcio lentamente al suelo.</p>
            <ul>
              <li>L√°valas, s√©calas y trit√∫ralas bien.</li>
              <li>Esp√°rcelas alrededor de las plantas.</li>
            </ul>
          </article>

          <article class="card">
            <h3>Cu√°ndo abonar</h3>
            <ul>
              <li>Evita abonar al mediod√≠a con sol fuerte.</li>
              <li>Prefiere primeras horas de la ma√±ana o final de la tarde.</li>
              <li>No sobre-abones: es mejor poco pero regular.</li>
            </ul>
          </article>
        </div>
      </section>

      <!-- ACERCA -->
      <section class="section" id="acerca" data-section="acerca">
        <div class="section-header">
          <div>
            <h2>Acerca de la aplicaci√≥n</h2>
            <p>Informaci√≥n r√°pida de Mi Siembra Inteligente.</p>
          </div>
          <span class="chip green">üì≤ Versi√≥n 1.0 (PWA)</span>
        </div>

        <div class="card">
          <h3>Mi Siembra Inteligente</h3>
          <p>
            Herramienta sencilla para organizar tu huerto casero: qu√© sembrar, un peque√±o plano 4√ó4,
            un diario de actividades y notas b√°sicas de plagas y abonos.
          </p>

          <div class="badge-row">
            <span class="badge green">PWA offline</span>
            <span class="badge blue">Datos guardados en el dispositivo</span>
            <span class="badge">Funciona en Chrome/Edge y Android</span>
          </div>

          <p style="margin-top:0.7rem;font-size:0.8rem;color:var(--text-soft);">
            Tus datos se guardan localmente en este dispositivo usando almacenamiento interno del navegador.
            No se env√≠an a ning√∫n servidor externo.
          </p>
        </div>
      </section>
    </main>

    <footer>
      <div>Mi Siembra Inteligente ¬∑ Guarda datos solo en este dispositivo ¬∑ Puedes instalarla como app desde el navegador</div>
      <div style="margin-top:0.3rem;">
        Mi Siembra Inteligente ‚Äî versi√≥n 1.0 (PWA)<br />
        Desarrollado por Ricardo D√≠az
      </div>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // --- Navegaci√≥n entre secciones ---
      const navButtons = document.querySelectorAll('.nav-pill');
      const sections = document.querySelectorAll('.section');

      function showSection(id) {
        sections.forEach(sec => {
          sec.classList.toggle('is-active', sec.dataset.section === id);
        });
        navButtons.forEach(btn => {
          btn.classList.toggle('is-active', btn.dataset.nav === id);
        });
      }

      navButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          showSection(btn.dataset.nav);
        });
      });

      // Desde tarjetas de inicio
      document.querySelectorAll('[data-goto]').forEach(btn => {
        btn.addEventListener('click', () => {
          const target = btn.getAttribute('data-goto');
          showSection(target);
          const navBtn = document.querySelector('.nav-pill[data-nav="' + target + '"]');
          if (navBtn) navBtn.focus();
        });
      });

      // --- Calendario de siembra ---
      const calendarioDatos = {
        0: [
          { cultivo: 'Tomate', detalle: 'Siembra en semillero, trasplanta cuando tenga 4‚Äì5 hojas.', dias: '90‚Äì110 d√≠as' },
          { cultivo: 'Lechuga', detalle: 'Prefiere clima m√°s fresco, ideal a inicios de a√±o.', dias: '45‚Äì60 d√≠as' }
        ],
        1: [
          { cultivo: 'Pimiento', detalle: 'Buenos resultados en clima c√°lido y estable.', dias: '90‚Äì120 d√≠as' },
          { cultivo: 'Cilantrillo', detalle: 'Siembra directa, varias tandas en el mes.', dias: '30‚Äì45 d√≠as' }
        ],
        2: [
          { cultivo: 'Pepinillo', detalle: 'Necesita buen sol y espacio para trepar.', dias: '50‚Äì70 d√≠as' },
          { cultivo: 'Habichuela tierna', detalle: 'Siembra directa, gu√≠a las plantas en estacas.', dias: '55‚Äì70 d√≠as' }
        ],
        3: [
          { cultivo: 'Calabaza', detalle: 'Deja espacio para que las gu√≠as se extiendan.', dias: '90‚Äì120 d√≠as' },
          { cultivo: 'Mel√≥n', detalle: 'Mejor con suelo bien drenado y suelto.', dias: '80‚Äì100 d√≠as' }
        ],
        4: [
          { cultivo: 'Ma√≠z tierno', detalle: 'Siembra en bloques para mejor polinizaci√≥n.', dias: '75‚Äì90 d√≠as' },
          { cultivo: 'Okra', detalle: 'Tolera bien el calor fuerte.', dias: '50‚Äì65 d√≠as' }
        ],
        5: [
          { cultivo: 'Yaut√≠a / ra√≠ces', detalle: 'Prepara bien el suelo, profundo y suelto.', dias: 'Varios meses' },
          { cultivo: 'Berenjena', detalle: 'Buen cultivo de clima c√°lido.', dias: '80‚Äì100 d√≠as' }
        ],
        6: [
          { cultivo: 'Aj√≠ dulce', detalle: 'Puede mantenerse produciendo por bastante tiempo.', dias: '90‚Äì120 d√≠as' },
          { cultivo: 'Culantro', detalle: 'Prefiere algo de sombra ligera.', dias: '60‚Äì90 d√≠as' }
        ],
        7: [
          { cultivo: 'Tomate tard√≠o', detalle: 'Ajusta seg√∫n el calor y lluvias.', dias: '90‚Äì110 d√≠as' },
          { cultivo: 'Lechugas de nuevo ciclo', detalle: 'Busca variedades que toleren calor.', dias: '45‚Äì60 d√≠as' }
        ],
        8: [
          { cultivo: 'Br√≥coli (si el clima lo permite)', detalle: 'Mejor en zonas m√°s frescas o con sombra.', dias: '80‚Äì100 d√≠as' },
          { cultivo: 'Re-siembra de cilantrillo', detalle: 'Mant√©n un ciclo continuo.', dias: '30‚Äì45 d√≠as' }
        ],
        9: [
          { cultivo: 'Repollo', detalle: 'Ideal si las noches empiezan a refrescar.', dias: '70‚Äì90 d√≠as' },
          { cultivo: 'Zanahoria', detalle: 'Suelo profundo y suelto para ra√≠ces rectas.', dias: '70‚Äì90 d√≠as' }
        ],
        10: [
          { cultivo: 'Habas / legumbres', detalle: 'Aprovecha finales de a√±o para nuevas tandas.', dias: '70‚Äì90 d√≠as' }
        ],
        11: [
          { cultivo: 'Revisi√≥n general del huerto', detalle: 'Planifica la rotaci√≥n para el pr√≥ximo a√±o.', dias: '‚Äî' }
        ]
      };

      const selectMes = document.getElementById('calendario-mes');
      const calendarioLista = document.getElementById('calendario-lista');

      const mesesNombres = [
        'Enero','Febrero','Marzo','Abril','Mayo','Junio',
        'Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'
      ];

      mesesNombres.forEach((nombre, index) => {
        const opt = document.createElement('option');
        opt.value = String(index);
        opt.textContent = nombre;
        selectMes.appendChild(opt);
      });

      function renderCalendario(mesIndex) {
        const items = calendarioDatos[mesIndex] || [];
        calendarioLista.innerHTML = '';
        if (!items.length) {
          const p = document.createElement('p');
          p.className = 'empty-state';
          p.textContent = 'No hay recomendaciones registradas para este mes.';
          calendarioLista.appendChild(p);
          return;
        }

        const grid = document.createElement('div');
        grid.className = 'card-grid';
        items.forEach(info => {
          const card = document.createElement('article');
          card.className = 'card';
          card.innerHTML = `
            <h3>${info.cultivo}</h3>
            <p>${info.detalle}</p>
            <div class="badge-row">
              <span class="badge green">Siembra este mes</span>
              <span class="badge">${info.dias}</span>
            </div>
          `;
          grid.appendChild(card);
        });
        calendarioLista.appendChild(grid);
      }

      selectMes.addEventListener('change', () => {
        renderCalendario(Number(selectMes.value));
      });

      const hoy = new Date();
      const mesActual = hoy.getMonth();
      selectMes.value = String(mesActual);
      renderCalendario(mesActual);

      // --- Cat√°logo de cultivos ---
      const catalogoDatos = [
        { nombre: 'Tomate', tipo: 'Fruto', sol: 'Pleno sol', notas: 'Le gusta el suelo bien drenado y tutorado.' },
        { nombre: 'Pimiento / Aj√≠ dulce', tipo: 'Fruto', sol: 'Pleno sol', notas: 'Puede producir por meses si se cuida bien.' },
        { nombre: 'Cilantrillo', tipo: 'Hoja', sol: 'Sol suave o sombra parcial', notas: 'Siembra escalonada para tener siempre fresco.' },
        { nombre: 'Lechuga', tipo: 'Hoja', sol: 'Sol suave', notas: 'Mejor en √©pocas menos calurosas.' },
        { nombre: 'Habichuela tierna', tipo: 'Leguminosa', sol: 'Pleno sol', notas: 'Aporta nitr√≥geno al suelo si se rota bien.' },
        { nombre: 'Calabaza', tipo: 'Fruto', sol: 'Pleno sol', notas: 'Necesita espacio para las gu√≠as.' },
        { nombre: 'Ma√≠z tierno', tipo: 'Cereal', sol: 'Pleno sol', notas: 'Siembra en bloques, no en una sola fila.' },
        { nombre: 'Culantro', tipo: 'Hoja', sol: 'Sombra ligera', notas: 'Mant√©n el suelo h√∫medo pero no encharcado.' }
      ];

      const catalogoGrid = document.getElementById('catalogo-grid');

      catalogoDatos.forEach(item => {
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <h3>${item.nombre}</h3>
          <p>${item.notas}</p>
          <div class="badge-row">
            <span class="badge green">${item.tipo}</span>
            <span class="badge">${item.sol}</span>
          </div>
        `;
        catalogoGrid.appendChild(card);
      });

      // --- Mi huerto 4√ó4 ---
      const HUERTO_KEY = 'mi-siembra-huerto';
      const huertoGrid = document.getElementById('huerto-grid');
      const huertoLimpiarBtn = document.getElementById('huerto-limpiar');

      let huertoEstado;
      try {
        const saved = localStorage.getItem(HUERTO_KEY);
        huertoEstado = saved ? JSON.parse(saved) : [];
      } catch {
        huertoEstado = [];
      }
      if (!Array.isArray(huertoEstado)) huertoEstado = [];
      while (huertoEstado.length < 16) huertoEstado.push('');

      function guardarHuerto() {
        try {
          localStorage.setItem(HUERTO_KEY, JSON.stringify(huertoEstado));
        } catch (err) {
          console.warn('No se pudo guardar el huerto', err);
        }
      }

      function renderHuerto() {
        huertoGrid.innerHTML = '';
        for (let i = 0; i < 16; i++) {
          const cell = document.createElement('button');
          cell.type = 'button';
          cell.className = 'huerto-cell';
          const valor = huertoEstado[i] || '';
          if (valor) {
            cell.classList.add('filled');
            cell.textContent = valor;
          } else {
            cell.textContent = 'Vac√≠o';
          }
          cell.setAttribute('data-index', String(i));
          huertoGrid.appendChild(cell);
        }
      }

      huertoGrid.addEventListener('click', (event) => {
        const target = event.target;
        if (!(target instanceof HTMLElement)) return;
        const index = target.getAttribute('data-index');
        if (index === null) return;
        const actual = huertoEstado[Number(index)] || '';
        const texto = prompt('¬øQu√© sembraste en este cuadro? (deja vac√≠o para limpiar)', actual);
        if (texto === null) return; // cancelar
        const limpio = texto.trim();
        huertoEstado[Number(index)] = limpio;
        guardarHuerto();
        renderHuerto();
      });

      huertoLimpiarBtn.addEventListener('click', () => {
        if (!confirm('¬øSeguro que quieres borrar todo el plano del huerto?')) return;
        huertoEstado = new Array(16).fill('');
        guardarHuerto();
        renderHuerto();
      });

      renderHuerto();

      // --- Diario de siembra ---
      const DIARY_KEY = 'mi-siembra-diario';
      const diaryForm = document.getElementById('diary-form');
      const diaryType = document.getElementById('diary-type');
      const diaryDate = document.getElementById('diary-date');
      const diaryNotes = document.getElementById('diary-notes');
      const diaryList = document.getElementById('diary-list');
      const diaryEmpty = document.getElementById('diary-empty');

      let diaryEntries;
      try {
        const saved = localStorage.getItem(DIARY_KEY);
        diaryEntries = saved ? JSON.parse(saved) : [];
      } catch {
        diaryEntries = [];
      }
      if (!Array.isArray(diaryEntries)) diaryEntries = [];

      function guardarDiario() {
        try {
          localStorage.setItem(DIARY_KEY, JSON.stringify(diaryEntries));
        } catch (err) {
          console.warn('No se pudo guardar el diario', err);
        }
      }

      function renderDiario() {
        diaryList.innerHTML = '';
        if (!diaryEntries.length) {
          diaryEmpty.style.display = 'block';
          return;
        }
        diaryEmpty.style.display = 'none';

        diaryEntries.forEach((entrada, index) => {
          const li = document.createElement('li');
          li.className = 'diary-item';
          const fechaTxt = entrada.fecha || '';
          li.innerHTML = `
            <div class="diary-item-header">
              <div class="diary-item-title">${entrada.tipo || 'Actividad'}</div>
              <div class="badge">${fechaTxt}</div>
            </div>
            <div class="diary-item-notes">
              ${entrada.notas ? entrada.notas.replace(/\n/g, '<br>') : '<em>Sin detalles adicionales.</em>'}
            </div>
            <div style="margin-top:0.4rem;display:flex;justify-content:flex-end;">
              <button type="button" class="btn small danger diary-delete" data-index="${index}">
                üóëÔ∏è Borrar
              </button>
            </div>
          `;
          diaryList.appendChild(li);
        });
      }

      diaryForm.addEventListener('submit', (event) => {
        event.preventDefault();
        const tipo = diaryType.value.trim();
        const fecha = diaryDate.value;
        const notas = diaryNotes.value.trim();

        if (!tipo || !fecha) {
          alert('Por favor indica el tipo de actividad y la fecha.');
          return;
        }

        diaryEntries.unshift({
          tipo,
          fecha,
          notas
        });

        guardarDiario();
        renderDiario();

        diaryForm.reset();
        // colocar fecha de hoy de nuevo
        diaryDate.valueAsDate = new Date();
      });

      diaryList.addEventListener('click', (event) => {
        const target = event.target;
        if (!(target instanceof HTMLElement)) return;

        if (target.classList.contains('diary-delete')) {
          const idx = target.getAttribute('data-index');
          if (idx === null) return;
          const index = Number(idx);
          if (Number.isNaN(index) || index < 0 || index >= diaryEntries.length) return;

          const entrada = diaryEntries[index];
          const confirmText = entrada && entrada.tipo
            ? `¬øBorrar la entrada "${entrada.tipo}" del diario?`
            : '¬øBorrar esta entrada del diario?';

          if (!confirm(confirmText)) return;

          diaryEntries.splice(index, 1);
          guardarDiario();
          renderDiario();
        }
      });

      // Fecha por defecto en el diario: hoy
      if (!diaryDate.value) {
        diaryDate.valueAsDate = new Date();
      }

      renderDiario();

      // --- Service Worker para PWA offline ---
      if ('serviceWorker' in navigator) {
        const swCandidatos = ['sw.js', 'service-worker.js'];
        swCandidatos.forEach((ruta) => {
          navigator.serviceWorker.register(ruta).catch(() => {
            // Ignorar errores si alg√∫n archivo no existe
          });
        });
      }
    });
  </script>
</body>
</html>
