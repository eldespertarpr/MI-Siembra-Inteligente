<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mi Siembra Inteligente (v18)</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#ffffff" />
  <style>
/* ------------------------------------------ */
/* MI SIEMBRA INTELIGENTE - ESTILOS v18       */
/* ------------------------------------------ */

:root {
  --bg: #ffffff;
  --bg-soft: #f8fafc;
  --text-main: #0f172a;
  --text-soft: #475569;
  --accent: #22c55e;
  --accent-strong: #16a34a;
  --border: #cbd5e1;
  --radius: 18px;
  --radius-lg: 22px;
  --shadow: 0 6px 16px rgba(0,0,0,0.08);
  --shadow-strong: 0 10px 30px rgba(0,0,0,0.15);
}

/* REGLAS GENERALES ------------------------------------------------ */

html, body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  font-family: system-ui, sans-serif;
  color: var(--text-main);
}

h2 {
  margin-top: 0;
  font-size: 22px;
  font-weight: 700;
}

p {
  font-size: 15px;
  color: var(--text-soft);
}

/* SPLASH SCREEN ---------------------------------------------------- */

#splash {
  position: fixed;
  inset: 0;
  background: #ffffff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  opacity: 1;
  transition: opacity 0.7s ease-out;
}

#splash.fade-out {
  opacity: 0;
  pointer-events: none;
}

#splash h1 {
  margin-top: 18px;
  font-weight: 700;
  font-size: 26px;
}

#splash p {
  margin-top: 4px;
  font-size: 16px;
  color: #64748b;
}

/* CABECERA --------------------------------------------------------- */

.app-header {
  background: #ffffffee;
  position: sticky;
  top: 0;
  z-index: 10;
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--border);
}

.header-inner {
  max-width: 960px;
  margin: 0 auto;
  padding: 12px 14px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.brand {
  display: flex;
  align-items: center;
  gap: 10px;
}

.brand-icon {
  width: 36px;
  height: 36px;
  border-radius: 14px;
  background: #22c55e22;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
}

.brand-title {
  font-size: 18px;
  font-weight: 700;
}

.brand-sub {
  font-size: 13px;
  color: var(--text-soft);
}

/* NAVEGACI√ìN ------------------------------------------------------- */

.pill-nav {
  display: flex;
  gap: 6px;
  background: var(--bg-soft);
  padding: 4px;
  border-radius: 999px;
  border: 1px solid var(--border);
}

.pill-nav button {
  border: none;
  border-radius: 999px;
  padding: 6px 12px;
  font-size: 13px;
  background: transparent;
  cursor: pointer;
  color: var(--text-soft);
}

.pill-nav .active {
  background: var(--accent);
  color: white;
}

/* VISTAS ----------------------------------------------------------- */

.view {
  display: none;
  padding: 18px;
  max-width: 960px;
  margin: 0 auto;
}

.view.active {
  display: block;
}

/* BOTONES ---------------------------------------------------------- */

button {
  cursor: pointer;
}

.home-buttons button {
  width: 100%;
  margin-bottom: 10px;
  padding: 14px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: #ffffff;
  font-size: 16px;
  font-weight: 600;
  text-align: left;
  box-shadow: var(--shadow);
  display: flex;
  gap: 10px;
  align-items: center;
}

/* CAT√ÅLOGO --------------------------------------------------------- */

#catalogSearch,
#pestSearch,
#pesticideSearch {
  width: 100%;
  padding: 12px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  font-size: 15px;
  margin-bottom: 12px;
}

#catalogGrid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
}

.crop-card {
  background: #ffffff;
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  overflow: hidden;
  transition: 0.15s ease-out;
}

.crop-card:hover {
  transform: translateY(-3px);
  box-shadow: var(--shadow-strong);
}

.crop-photo {
  height: 100px;
  background: #e2e8f0;
}

.crop-photo img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.crop-body {
  padding: 10px;
}

.crop-name {
  font-size: 15px;
  font-weight: 700;
}

.crop-tag {
  display: inline-block;
  padding: 3px 7px;
  margin-right: 4px;
  margin-top: 4px;
  font-size: 12px;
  border-radius: 8px;
  background: var(--bg-soft);
  border: 1px solid var(--border);
}

/* MI HUERTO -------------------------------------------------------- */

#gardenGrid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
}

.garden-cell {
  background: #ffffff;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  padding: 8px;
  min-height: 80px;
  box-shadow: var(--shadow);
}

/* DIARIO ----------------------------------------------------------- */

#diaryList {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.diary-entry {
  background: #ffffff;
  border-radius: var(--radius);
  padding: 12px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
}

.diary-type {
  font-weight: 700;
  color: var(--accent-strong);
}

/* PLAGAS ----------------------------------------------------------- */

#pestsList .list-item,
#pesticidesList .list-item {
  background: #ffffff;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px;
  box-shadow: var(--shadow);
  margin-bottom: 10px;
}

/* FOOTER ----------------------------------------------------------- */

footer {
  padding: 20px;
  text-align: center;
  color: var(--text-soft);
  font-size: 13px;
}
</style>
</head>

<body>

  <!-- üå± SPLASH SCREEN -->
  <div id="splash">
    <div style="font-size:64px;">üå±</div>
    <h1>Mi Siembra Inteligente</h1>
    <p>El huerto en tus manos</p>
  </div>

  <!-- üåø APP CONTENEDOR -->
  <div id="app" style="display:none;">

    <header class="app-header">
      <div class="header-inner">
        <div class="brand">
          <div class="brand-icon"><span>üå±</span></div>
          <div class="brand-text">
            <div class="brand-title">Mi Siembra Inteligente</div>
            <div class="brand-sub">Planifica, registra y cuida tu huerto paso a paso.</div>
          </div>
        </div>

        <nav class="pill-nav">
          <button class="nav-btn active" data-view="homeView">üè† Inicio</button>
          <button class="nav-btn" data-view="calendarView">üìÖ Calendario</button>
          <button class="nav-btn" data-view="catalogView">üåø Cat√°logo</button>
          <button class="nav-btn" data-view="moreView">‚ãØ M√°s</button>
        </nav>
      </div>
    </header>

    <main>

      <!-- üè† INICIO -->
      <section id="homeView" class="view active">
        <h2>Inicio</h2>
        <p>Elige qu√© deseas hacer hoy.</p>

        <div class="home-buttons">
          <button data-view-target="calendarView">üìÖ Qu√© sembrar este mes</button>
          <button data-view-target="catalogView">üåø Cat√°logo de cultivos</button>
          <button data-view-target="gardenView">üß© Mi huerto</button>
          <button data-view-target="diaryView">üìì Diario</button>
          <button data-view-target="pestsView">ü™≤ Plagas y cuidados</button>
          <button data-view-target="fertView">üß™ Abonos y fertilizantes</button>
        </div>
      </section>

      <!-- üìÖ CALENDARIO -->
      <section id="calendarView" class="view">
        <h2>¬øQu√© puedo sembrar este mes?</h2>
        <div id="monthButtons"></div>
        <div id="monthResults"></div>
      </section>

      <!-- üåø CAT√ÅLOGO -->
      <section id="catalogView" class="view">
        <h2>Cat√°logo visual de cultivos</h2>
        <input id="catalogSearch" placeholder="Buscar cultivo...">
        <div id="catalogTypeFilters"></div>
        <div id="catalogSunFilters"></div>
        <div id="catalogGrid"></div>
      </section>

      <!-- üß© MI HUERTO -->
      <section id="gardenView" class="view">
        <h2>Mi huerto</h2>
        <div id="gardenGrid"></div>
      </section>

      <!-- üìì DIARIO -->
      <section id="diaryView" class="view">
        <h2>Diario de siembra</h2>
        <button id="addDiaryEntry">‚ûï A√±adir</button>
        <div id="diaryList"></div>
      </section>

      <!-- ü™≤ PLAGAS -->
      <section id="pestsView" class="view">
        <h2>Plagas y cuidados</h2>
        <button data-view-target="pestsCatalogView">üìö Cat√°logo de plagas</button>
        <button data-view-target="pesticidesView">üß¥ Pesticidas caseros</button>
      </section>

      <!-- üìö CAT√ÅLOGO DE PLAGAS -->
      <section id="pestsCatalogView" class="view">
        <h2>Cat√°logo de plagas</h2>
        <input id="pestSearch" placeholder="Buscar plaga...">
        <div id="pestTypeFilters"></div>
        <div id="pestsList"></div>
      </section>

      <!-- üß¥ PESTICIDAS -->
      <section id="pesticidesView" class="view">
        <h2>Pesticidas caseros</h2>
        <input id="pesticideSearch" placeholder="Buscar pesticida...">
        <div id="pesticideTypeFilters"></div>
        <div id="pesticidesList"></div>
      </section>

      <!-- ‚öôÔ∏è OPCIONES -->
      <section id="optionsView" class="view">
        <h2>Opciones y clima</h2>
        <div id="climateOptionsRow"></div>
        <p>Clima actual: <strong id="optionsClimateText"></strong></p>
      </section>

      <!-- ‚ãØ M√ÅS -->
      <section id="moreView" class="view">
        <h2>M√°s opciones</h2>

        <button data-view-target="gardenView">üß© Mi huerto</button>
        <button data-view-target="diaryView">üìì Diario</button>
        <button data-view-target="pestsView">ü™≤ Plagas</button>
        <button data-view-target="fertView">üß™ Abonos</button>
        <button id="backupExport">üíæ Guardar copia</button>
        <button id="backupImport">üìÇ Restaurar copia</button>
        <input type="file" id="backupFile" accept="application/json" hidden />
      </section>

      <!-- üß™ ABONOS -->
      <section id="fertView" class="view">
        <h2>Abonos y fertilizantes</h2>
        <div id="fertList"></div>
      </section>

    </main>

    <footer>
      Mi Siembra Inteligente ¬∑ Datos guardados solo en este dispositivo
    </footer>

  </div>

  <script>
// Esperar a que cargue todo
document.addEventListener("DOMContentLoaded", () => {

    // ---- SPLASH ----
    setTimeout(() => {
        const splash = document.getElementById("splash");
        splash.classList.add("fade-out");

        setTimeout(() => {
            splash.style.display = "none";
            document.getElementById("app").style.display = "block";
        }, 400);

    }, 1200);


    // ---- NAVEGACI√ìN ----
    const pages = document.querySelectorAll(".page");
    const navButtons = document.querySelectorAll("[data-page]");

    function showPage(id) {
        pages.forEach(p => p.style.display = "none");
        document.getElementById(id).style.display = "block";
    }

    navButtons.forEach(btn => {
        btn.addEventListener("click", () => {
            const page = btn.getAttribute("data-page");
            showPage(page);
        });
    });

    showPage("inicio"); // primera pantalla


    // ---- BASE DE DATOS DE CULTIVOS ----
    const cultivos = [
        { nombre: "Tomate", tipo: "fruto", meses: ["ene","feb","mar","abr","may","jun","jul","ago","sep","oct"], dias: "70‚Äì90 d√≠as", sombra: "Pleno sol", riego: "Medio" },
        { nombre: "Lechuga", tipo: "hoja", meses: ["ene","feb","mar","abr","oct","nov","dic"], dias: "30‚Äì45 d√≠as", sombra: "Media sombra", riego: "Alto" },
        { nombre: "R√°banos", tipo: "ra√≠z", meses: ["todo"], dias: "20‚Äì30 d√≠as", sombra: "Sol", riego: "Medio" },
        { nombre: "Pimiento", tipo: "fruto", meses: ["feb","mar","abr","may","jun"], dias: "90‚Äì110 d√≠as", sombra: "Pleno sol", riego: "Medio" }
    ];


    // ---- CAT√ÅLOGO DE CULTIVOS (tarjetas) ----
    const catalogoCont = document.getElementById("catalogo-lista");

    function renderCatalogo(lista) {
        catalogoCont.innerHTML = "";
        lista.forEach(c => {
            const card = document.createElement("div");
            card.className = "card fade-in";
            card.innerHTML = `
                <h3>${c.nombre}</h3>
                <p><strong>Tipo:</strong> ${c.tipo}</p>
                <p><strong>D√≠as de cosecha:</strong> ${c.dias}</p>
                <button class="verMasBtn">Ver m√°s</button>
            `;
            card.addEventListener("click", () => abrirDetalle(c));
            catalogoCont.appendChild(card);
        });
    }

    renderCatalogo(cultivos);


    // ---- DETALLE AMPLIADO ----
    const dialogDetalle = document.getElementById("detalleCultivo");
    const detalleContent = document.getElementById("detalleContenido");
    const cerrarDetalle = document.getElementById("cerrarDetalle");

    function abrirDetalle(c) {
        detalleContent.innerHTML = `
            <h2>${c.nombre}</h2>
            <p><strong>Tipo:</strong> ${c.tipo}</p>
            <p><strong>D√≠as de cosecha:</strong> ${c.dias}</p>
            <p><strong>Sombra:</strong> ${c.sombra}</p>
            <p><strong>Riego:</strong> ${c.riego}</p>
        `;
        dialogDetalle.showModal();
    }

    cerrarDetalle.addEventListener("click", () => dialogDetalle.close());


    // ---- CALENDARIO ----
    const calendarioLista = document.getElementById("calendario-lista");
    const botonesMes = document.querySelectorAll(".btnMes");

    botonesMes.forEach(btn => {
        btn.addEventListener("click", () => {
            botonesMes.forEach(b => b.classList.remove("activo"));
            btn.classList.add("activo");

            const mes = btn.dataset.mes;

            const resultado = cultivos.filter(c =>
                c.meses.includes(mes) || c.meses.includes("todo")
            );

            renderMes(resultado);
        });
    });

    function renderMes(lista) {
        calendarioLista.innerHTML = "";
        if (lista.length === 0) {
            calendarioLista.innerHTML = `<p>No hay cultivos sugeridos.</p>`;
            return;
        }
        lista.forEach(c => {
            const card = document.createElement("div");
            card.className = "card fade-in";
            card.innerHTML = `
                <h3>${c.nombre}</h3>
                <p>${c.dias}</p>
            `;
            calendarioLista.appendChild(card);
        });
    }


    // ---- BUSCADOR ----
    const inputBuscador = document.getElementById("buscar");

    inputBuscador.addEventListener("input", () => {
        const texto = inputBuscador.value.toLowerCase();
        const filtrados = cultivos.filter(c =>
            c.nombre.toLowerCase().includes(texto)
        );
        renderCatalogo(filtrados);
    });


    // ---- PLAGAS ----
    const plagas = [
        { nombre: "Pulgones", descripcion: "Insectos peque√±os que chupan savia." },
        { nombre: "Mosca blanca", descripcion: "Plaga com√∫n en hojas tiernas." }
    ];

    const listaPlagas = document.getElementById("lista-plagas");
    plagas.forEach(p => {
        listaPlagas.innerHTML += `
            <div class="card">
                <h3>${p.nombre}</h3>
                <p>${p.descripcion}</p>
            </div>`;
    });


    // ---- DIARIO ----
    const diarioLista = document.getElementById("diario-lista");
    const btnAgregarNota = document.getElementById("agregarNota");
    const notaInput = document.getElementById("nota");

    btnAgregarNota.addEventListener("click", () => {
        if (!notaInput.value) return;
        const div = document.createElement("div");
        div.className = "card";
        div.textContent = notaInput.value;
        diarioLista.appendChild(div);
        notaInput.value = "";
    });


    // ---- MI HUERTO ----
    const miHuertoLista = document.getElementById("miHuertoLista");
    const btnAgregarHuerto = document.getElementById("agregarHuerto");
    const inputHuerto = document.getElementById("nuevoHuerto");

    btnAgregarHuerto.addEventListener("click", () => {
        if (!inputHuerto.value) return;
        const div = document.createElement("div");
        div.className = "card";
        div.textContent = inputHuerto.value;
        miHuertoLista.appendChild(div);
        inputHuerto.value = "";
    });

});
</script>
</body>
</html>
